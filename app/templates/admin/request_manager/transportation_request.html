{% extends 'admin/request_manager/create_request.html' %}
{% import 'macros/form_macros.html' as f %}

{% block scripts %}
{% endblock %}

{% block create_request_content %}
{% set flashes = {
'error': get_flashed_messages(category_filter=['form-error']),
'warning': get_flashed_messages(category_filter=['form-check-email']),
'info': get_flashed_messages(category_filter=['form-info']),
'success': get_flashed_messages(category_filter=['form-success'])
} %}

{{ f.begin_form(form, flashes) }}
<div class="ui stackable centered grid container">
  <div class="twelve wide column">
    <h2 class="ui center aligned header">
      Transportation Request Form
    </h2>
  </div>

  <div class="twelve wide column">
    <div class="ui two column stackable grid">
      <div class="six wide column">
        {{ f.render_form_field(form.date_created) }}
      </div>
    </div>
  </div>

  <div class="twelve wide column">
    {{ f.render_form_field(form.requesting_member)}}
  </div>

  <div class="twelve wide column">
    <div class="ui two column stackable relaxed grid">
      <div class="two column row">
        <div class="six wide column">
          {{ f.render_form_field(form.requested_date) }}
        </div>
        <div class="right floated six wide column">
          {{ f.render_form_field(form.time_flexible) }}
        </div>
      </div>
      <div class="two column row">
        <div class="six wide column">
          {{ f.render_form_field(form.initial_pickup) }}
        </div>
        <div class="right floated six wide column">
          {{ f.render_form_field(form.return_pickup) }}
        </div>
      </div>
      <div class="two column row">
        <div class="six wide column">
          {{ f.render_form_field(form.appointment) }}
        </div>
        <div class="right floated six wide column">
          {{ f.render_form_field(form.drop_off) }}
        </div>
      </div>
    </div>
  </div>

  <div class="twelve wide column">
    {{ f.render_form_field(form.description) }}
  </div>

  <div class="twelve wide column">
    <div class="ui two column stackable grid">
      <div class="six wide column">
        {{ f.render_form_field(form.service_category) }}
      </div>
      <div class="right floated six wide column">
        <div id="covid" style="display:none;">
          {{ f.render_form_field(form.covid_service) }}
        </div>
        <!-- <p id="p">paragraph!</p> -->
        <div id="transportation">
          {{ f.render_form_field(form.transportation_service) }}
        </div>
      </div>
      <div class="right floated six wide column">
      </div>
    </div>

    <div>{{ f.render_form_field(form.starting_location) }}</div>
    <!-- <div class="ui two column stackable relaxed grid"> -->
    <!-- <div class="two column row"> -->
    <!-- <div class="eight wide column"> -->
    {{ f.render_form_field(form.destination) }}
    <!-- </div> -->
    <!-- <div class="right floated four wide column"> -->
    <button class="ui inverted violet fluid button" id="show-new-destinations">
      Add new destination</button>
    <!-- </div> -->
    <!-- </div> -->
    <!-- </div> -->
    <div>{{ f.render_form_field(form.duration) }}</div>
  </div>

  <div id="new-destination" class="ui modal">
    <i class="close icon"></i>
    <div class="header">Add Availability</div>
    <div class="content">
      <h3>Add new destination</h3>
      {{f.render_form_field(form.destination_name)}}
      {{f.render_form_field(form.street_address1)}}
      {{f.render_form_field(form.street_address2)}}
      {{f.render_form_field(form.city)}}
      {{f.render_form_field(form.state)}}
      {{f.render_form_field(form.zip)}}
      {{f.render_form_field(form.country)}}
      {{f.render_form_field(form.add_address)}}
    </div>
  </div>

  <script>
    $('#show-new-destination').click(function () {
      $('#new-destination').modal('show');
    });

    function serviceChoices() {
      let service_category = document.getElementById("service_category").value;
      // document.getElementById("p").style.display = "none";
      if (service_category === "1") {
        document.getElementById("covid").style.display = "initial";
        document.getElementById("transportation").style.display = "none";
      } else if (service_category === "0") {
        document.getElementById("covid").style.display = "none"
        document.getElementById("transportation").style.display = "initial"
      }
    }

    // function specialInstructions() {
    //   let special_instructions = document.getElementById("special_instructions");
    //   let obj = JSON.parse(special_instructions.innerText);
    //   let p = document.createElement('p');
    //   p.innerText = special_instructions.innerText;
    //   document.getElementById('p').appendChild(p);
    //   let id = document.getElementById('member').value;

    // }
  </script>

  <div class="twelve wide column">
    {{ f.render_form_field(form.special_instructions) }}

  </div>

  <div class="twelve wide column">
    <div class="ui two column stackable grid">
      <div class="six wide column">
        {{ f.render_form_field(form.follow_up_date) }}
        {{ f.render_form_field(form.responsible_staffer) }}
      </div>
      <div class="right floated six wide column">
        {{ f.render_form_field(form.status) }}
        {{ f.render_form_field(form.contact_log_priority) }}
      </div>
    </div>
  </div>

  <div class="twelve wide column">
    {{ f.render_form_field(form.person_to_cc) }}
  </div>

  <div class="form_errors">
    {{ form.requesting_member.data }}
  </div>

  <div class="twelve wide column">

    {{ f.form_message(flashes['error'], header='Something went wrong.', class='error') }}
    {{ f.form_message(flashes['warning'], header='Check your email.', class='warning') }}
    {{ f.form_message(flashes['info'], header='Information', class='info') }}
    {{ f.form_message(flashes['success'], header='Success!', class='success') }}

    {% for field in form | selectattr('type', 'equalto', 'SubmitField') %}
    {{ f.render_form_field(field, extra_classes=".ui .button") }}
    {% endfor %}
  </div>
</div>
{{ f.end_form() }}
{% endblock %}